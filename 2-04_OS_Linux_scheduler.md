# Домашнее задание к занятию "2.8 Шедулер"

---

### Задание 1

Какие операции замедляют работу компьютера в многозадачных системах?

*Приведите ответ в свободной форме со своим комментарием.*

***Ответ:***

В многозадачных системах работу компьютера могут замедлять операции смены контекста, т.е. переключение от одного, готового к выполнению, процесса к другому. При переключении процесса, необходимо сохранить контекст, изменить дескриптор процесса, прогреть кэш. В этих процедурах задействованы: процессор, кэш, шина данных и оперативная память. Если процессы одной программы распределяются на несколько ядер процессора, то все перечисленные процедуры будут замедлять ее выполнение. Однако можно оптимизировать скорость выполнения программы, перенеся выполнение всех процессов на одно процессорное ядро, таким образом сократив количество операций смены контекста.

---

### Задание 2

В каких ситуациях планировщик ввода / вывода `noop` может быть производительней `cfq`?

*Приведите ответ в свободной форме со своим комментарием.*

***Ответ:***

Планировщик ввода/вывода `noop` может быть производительней `cfq` в ситуации, если система работает с сетевым хранилищем или в виртуальной машине. `Noop` в данном случае не будет вмешиваться в алгоритмы, работающие на сетевом хранилище и хосте виртуальной машины. Он выполнит только объединение приходящих запросов со смежными, которые находятся в очереди. Кроме этого, больше никаких функций у данного планировщика нет. Он просто обслужит очередь запросов, которые передаются драйверу блочного устройства, в режиме FIFO. Все остальные операции будут выполнены алгоритмами сетевого хранилища и хоста ВМ.

---

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (необязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 3

Запустите следующий код, имитирующий нагрузку типа ввод / вывод, с разными приоритетами. Объясните получившееся различие во времени исполнения для разных запусков.

    dd if=/dev/zero of=test bs=1 count=10000000

*Приведите ответ в свободной форме со своим комментарием.*

***Ответ:***

Как показывает проведенное исследование (вывод команд ниже), при увеличении приоритета выявляется тенденция к уменьшению времени выполнения процесса и увеличению скорости копирования блочных данных. Данную тенденцию можно охарактеризовать тем, что при увеличении приоритета, система выделяет большее количество ресурсов процессу. Это приводит к увеличению скорости выполнения. Что интересно, в ситуации, когда команда запускалась из консоли (рис 3.1), для нее на моей ВМ самого быстрого выполнения удалось достичь при увеличении приоритета до -10. Процесс с приоритетом -15 и -20 показал результат немного хуже, чем процесс с приоритетом -10. В данном случае, заданные приоритеты процесса могли отличаться от реального, примененного планировщиком, поэтому процесс с приоритетами -15 и -20 мог показать такой результат. А вот в ситуации, когда команда запускалась скриптом, она отработала строго в соответствии с приоритетом ( рис. 3.2)

<a href="https://ibb.co/r0fXqfd"><img src="https://i.ibb.co/T2qNJqW/3-1.png" alt="3-1" border="0"></a>

<a href="https://ibb.co/qWXQKmM"><img src="https://i.ibb.co/D8s2hwD/3-2.png" alt="3-2" border="0"></a>

---

### Задание 4

При каких условиях лучше увеличить time slice планирования, а когда лучше уменьшить?

*Приведите ответ в свободной форме со своим комментарием.*

***Ответ:***

Time slice (квант времени) — это численное значение, которое характеризует, как долго может выполняться задание до того момента, пока оно не будет вытеснено. Стратегия планирования должна устанавливать значение кванта времени, используемое по умолчанию, что является непростой задачей. Слишком большое значение time slice приведет к ухудшению интерактивной производительности системы. Больше не будет впечатления, что процессы выполняются параллельно. Слишком малое значение кванта времени приведет к возрастанию накладных расходов на переключение между процессами, так как больший процент системного времени будет уходить на переключение с одного процесса с малым квантом времени на другой процесс с малым квантом времени. В связи с этим, tine slice лучше увеличивать на серверах и уменьшать на пользовательских машинах.

---

### Задание 5

Запустите веб-браузер с разными приоритетами. Создайте условия, чтобы получить различную отзывчивость браузера при использовании разных приоритетов. Запишите условия и опишите результаты.

*Приведите ответ в свободной форме со своим комментарием.*

***Ответ:***

Веб-браузер запускался 3 раза со следующими приоритетами: ni 19, ni 0, ni -20. В браузере запускались видео с видеохостинга youtube. Наилучшая отзывчивость была достигнута с приоритетом ni -20, утилита htop показывала, что процессу отдано 68% процессорного времни. В браузере динамичнее открывались вкладки, даже при запущенном видеопотоке. Однако, переключение на другие задачи вызывало подвисание системы. Установка приоритета в ni 0 привела к тому, что процессорное время отданное браузеру сократилось до 58%. В целом браузер не очень потерял в процессе воспроизведения видео, дополнительные вкладки открывались чуть медленнее. В целом, система стала более отзывчивой при переключении на другие задачи. Установка приоритета в ni 19 привела к тому, что процессорное время сократилось до 46%-52% (присутствовали колебания). Браузер стал менее отзывчивым, видео немного подтормаживало в процессе воспроизведения, вкладки открывались с небольшой задержкой. Переключение на другие задачи было в целом таким же, как в приоритете ni 0. Вывод: для приемлемой работы системы я бы выбрал приоритет по умолчанию. Если небходимо сделать приложение более отзывчивым, тогда есть смысл увеличить приоритет выполнения. Снижать приоритет выполнения имеет смысл только для процессов, работающих в фоновом режиме и несильно влияющих на быстродействие системы.

---