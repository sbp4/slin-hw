# Домашнее задание к занятию "2.6 Ядро операционной системы"

---

### Задание 1

При каких событиях выполнение процесса переходит в режим ядра?

*Приведите ответ в свободной форме.*

***Ответ:***

Выполнение в режиме ядра - это передача ядру контроля над процессом для выполнения необходимой задачи. Существует всего три события, при которых выполнение процесса переходит в режим ядра: 1. ситемные вызовы; 2. аппаратные прерывания; 3. особые ситуации. Системный вызов - это механизм взаимодействия пользовательских программ с ядром linux. Он всегда исходит от пользователя. Возникает, когда мы хотим попросить ядро сделать какую-то процедуру за нас. К примеру открыть файл. Основыне системыне вызовы - read, write, open, close. Аппаратное прерывание - это внешнее ассинхронное событие, которое поступает от аппаратуры. Генерируется переферийными устройствами при наступлении определенного события. К примеру, устройство сломалось или сетевой интерфейс отправил все данные и должен оповестить ядро об окончании процедуры отправки. Это прерывание, как правило, не связано с текущим процессом, а вызвано внешним событием. В отличие от аппаратных прерываний, особые ситуации вызваны самим процессом, и связаны с выполнением тех или иных инструкций, например, деление на ноль или обращение к несуществующей странице памяти. Обработка особых ситуаций производится в контексте процесса, при этом может использоваться его адресное пространство, а сам процесс — при необходимости блокироваться (перемещаться в состояние сна).

---

### Задание 2

Найдите имя автора модуля `libcrc32c`.

*В качестве ответа приложите скриншот вывода команды.*

***Ответ:***

Имя автора модуля: Clay Haapala

<a href="https://ibb.co/PQxVznB"><img src="https://i.ibb.co/q5B2Ffb/2-1.png" alt="2-1" border="0"></a>

---
### Задание 3

Используя утилиту `strace` выясните какой системный вызов использует команда `cd`.

*Примечание:* она не является внешним файлом, но для наших целей можно схитрить: `strace bash -c cd /tmp`.

*В качестве ответа напишите название системного вызова.*

***Ответ:***

Команда 'cd' использует системный вызов 'execve'

<a href="https://ibb.co/nCGt07Q"><img src="https://i.ibb.co/0t7vXCY/3-1.png" alt="3-1" border="0"></a>

---

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (необязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 4

**Соберите свой модуль и загрузите его в ядро.**

*Примечание:* лучше использовать чистую виртуальную машину Ubuntu, чтобы нивелировать шанс сломать систему. 

**1) Установим необходимые пакеты:**

`apt-get install gcc make linux-headers-$(uname -r)`

**2) Создаем файл модуля:**

```
mkdir kmod-hello_world
cd kmod-hello_world/
touch ./mhello.c
```

```
#define MODULE
#include <linux/module.h>
#include<linux/init.h>
#include <linux/kernel.h>

int init_module(void){
    printk("<1> Hello,World\n");
    return 0;
}

void cleanup_module(void){
    printk("<1> Goodbye.\n");
}
```

**3) Создаем Makefile:**
`touch ./Makefile`

```
obj-m += mhello.o

hello-objs := mhello.c

all:
       make -C /lib/modules/$(shell uname -r)/build/ M=$(PWD) modules

clean:
       make -C /lib/modules/$(shell uname -r)/build/ M=$(PWD) clean
```
**4) Собираем модуль и устанавливаем его с помощью insmod.**

*В качестве ответа приложите скриншот вывода установки модуля в `dmesg`.*

***Ответ:***

<a href="https://ibb.co/DpMPR1T"><img src="https://i.ibb.co/zJ2W4mD/4-1.png" alt="4-1" border="0"></a>